# -*- coding: utf-8 -*- 
from urllib2 import urlopen, Request
from urllib import urlencode, unquote, quote
import re
import web
import utils
from datetime import date

def trains(from_station, to_station):
    """Returns a list of all trains between from_station and to_station
    
    Each train is a dictionary with the following keys: departure, arrival, kind, duration
    """
    # urllib.urlencode doesn't like unicodes
    from_station, to_station = [s.encode('utf-8') for s in (from_station, to_station)]
    # obtain session cookie
    res = urlopen('http://razpisanie.bdz.bg/site/search.jsp')
    cookies = res.info().getheaders('Set-Cookie')
    cookies = [s.split(';')[0] for s in cookies]
    cookies_header = '; '.join(cookies)

    args = {'from_station':  from_station, 'to_station':    to_station, 'date':  date.today().strftime('%d/%m/%Y'), 'dep_arr':  1,
        'time_from':    '00:00', 'time_to':  '24:00', 'via_station':    '', 'via_min_time':  '00:01', 'all_cats':    'checked',
        'cardId':    30, 'class':    0, 'sort_by':  0, 'x':  37, 'y':    11,}

    headers = {'Cookie': cookies_header,}

    req = Request('http://razpisanie.bdz.bg/SearchServlet?action=listOptions', urlencode(args), headers)

    res = urlopen(req)
    # bdz.bg web server doesn't understand Connection: close and doesn't actually close the connection
    text = ''
    for line in res:
        text += line
        if '</html>' in line:
            break

    res.close()

    trains_re = ur"""
        <div\s+class="accordionTabTitleBar"
            .*?
            <td.*?>.*?</td>.*?
            <td.*?>(?P<departure>.*?)</td>.*?
            <td.*?>(?P<arrival>.*?)</td>.*?
            <td.*?>(?P<kind>.*?)</td>.*?
            <td.*?>(?P<between>.*?)</td>.*?
            <td.*?>(?P<duration>.*?)</td>.*?
        </div>
    """

    return [m.groupdict() for m in re.finditer(trains_re, text, re.X | re.S | re.U)]

def stations():
    """Returns all listable station names by type. A dictinary with three elements: main, other and user"""
    return {
        'main': main_stations,
        'other': other_stations,
        'user': user_stations()
    }

"""If not None, should be a list to oveeride the user stations retrieved from the cookie"""
forced_user_stations = None

def user_stations():
    """Returns a list of user-defined stations"""
    if forced_user_stations: return forced_user_stations
    return list(set(filter(lambda _: _, unicode(unquote(web.cookies(user_stations='').get('user_stations')), 'utf-8').split('|'))))

normalize_station_name = lambda s: s.lower().replace(' ', '').replace('-', '')
    
def add_to_user_stations(*stations):
    """Adds these stations to the user-defined stations list in a cookie. Doesn't add stations, which are in the short lists."""
    global forced_user_stations
    known_stations = utils.intersection_by_key(set(stations), set(main_stations + other_stations), normalize_station_name)
    unknown_stations = set(stations) - known_stations
    if not unknown_stations: return
    new_user_stations = list(set(user_stations() + list(unknown_stations)))
    forced_user_stations = new_user_stations
    new_user_stations_cookie = u'|'.join(new_user_stations).encode('utf-8')
    web.setcookie('user_stations', quote(new_user_stations_cookie), 365 * 24 * 60 * 60)

def cyr_to_lat_station(lat):
    """Returns the cyrllic name of the station, if such a station exists. Otherwise you get the original name."""
    if lat == 'missing': return ''
    cyrs = utils.cyr_from_lat_all(lat)    
    intersect = utils.intersection_by_key(set(cyrs), set(all_stations), normalize_station_name)
    if intersect: return list(intersect)[0].title()
    if cyrs: return list(cyrs)[0].title()
    return None

def canonical_station(station):
    """Returns the a transformed name (transliterated) of the station to be used for searching"""
    if not utils.has_cyrillic_letters(station):
        cyr = cyr_to_lat_station(station)
    if cyr: return cyr
    return station
    
contact_places = [
    ['Централна ЖП гара', 42.711898, 23.322446, '+35929311111'],
    ['ЖП гара Горна Оряховица', 43.136193, 25.6917, '+35961856050'],
    ['ЖП гара Варна', 43.228194, 27.92347, '+35952630414'],
    ['ЖП гара Пловдив', 42.135026, 24.741935, '+35932622729'],
    ['ЖП гара Русе', 43.838118, 25.956874, '+35982820222'],
    ['ЖП гара Бургас', 42.495106,27.476056, '+35956845022'],    
]
contact_places = [{'title': unicode(place[0], 'utf-8'), 'latitude': place[1], 'longitude': place[2], 'phone': place[3]} for place in contact_places]

main_stations = [
    'СОФИЯ',
    'ВАРНА',
    'БУРГАС',
    'ПЛОВДИВ',
    'РУСЕ',
    'ГОРНА ОРЯХОВИЦА',
    'ВИДИН',
    'ПЛЕВЕН',
    'МЕЗДРА',
    'СТАРА ЗАГОРА']
main_stations = [unicode(s, 'utf-8').title() for s in main_stations]    

other_stations = [
    'АЙТОС',
    'АСЕНОВГРАД',
    'БАНКЯ',
    'БАНСКО',
    'БЛАГОЕВГРАД',
    'ВЕЛИКО ТЪРНОВО',
    'ВЕЛИНГРАД',
    'ВРАЦА',
    'ГАБРОВО',
    'ДИМИТРОВГРАД',

    'ДОБРИЧ',
    'ДЪБОВО',
    'КАЗАНЛЪК',
    'КАЛОТИНА',
    'КАРЛОВО',
    'КАРНОБАТ',
    'КОПРИВЩИЦА',
    'КЪРДЖАЛИ',
    'КЮСТЕНДИЛ',
    'ЛАКАТНИК',
    'ЛЕВСКИ',
    'ЛОВЕЦ',
    'ЛОМ',
    'ЛУКОВИТ',
    'МОМЧИЛГРАД',
    'МОНТАНА',
    'НОВА ЗАГОРА',
    'ПАВЛИКЕНИ',
    'ПАЗАРДЖИК',
    'ПАНАГЮРИЩЕ',
    'ПЕРНИК',
    'ПЕЩЕРА',
    'ПОПОВО',
    'ПЪРВОМАЙ',
    'РАЗГРАД',
    'РОМАН',
    'САНДАНСКИ',
    'СВИЛЕНГРАД',
    'СВИЩОВ',
    'СВОГЕ',
    'СЕПТЕМВРИ',
    'СИЛИСТРА',
    'СИМЕОНОВГРАД',
    'СИМИТЛИ',
    'СЛИВЕН',
    'СОФИЯ СЕВЕР',
    'СТАМБОЛИЙСКИ',
    'ТРОЯН',
    'ТЪРГОВИЩЕ',
    'ХАСКОВО',
    'ХИСАР',
    'ЧЕРВЕН БРЯГ',
    'ШУМЕН',
    'ЯМБОЛ',]
other_stations = [unicode(s, 'utf-8').title() for s in other_stations]

all_stations = [
    'СОФИЯ',
    'ВАРНА',
    'БУРГАС',
    'ПЛОВДИВ',
    'РУСЕ',
    'ГОРНА ОРЯХОВИЦА',
    'ВИДИН',
    'ПЛЕВЕН',
    'МЕЗДРА',

    'СТАРА ЗАГОРА',
    'АБЛАНИЦА',
    'АВРАМОВО',
    'АЙТОС',
    'АЛ.ДИМИТРОВ',
    'АЛДОМИРОВЦИ',
    'АЛЕКСАНДРОВО',
    'АЛФАТАР',
    'АНЕВО',

    'АНТОН',
    'АРКОВНА',
    'АСЕНОВГРАД',
    'АСЕНОВО',
    'АСЕНОВЦИ',
    'АСПАРУХОВО',
    'АТОЛОВО',
    'БАЙКОВО',
    'БАЛКАН',

    'БАНКОВИЦА',
    'БАНКЯ',
    'БАНСКО',
    'БАНЯ',
    'БАТАНОВЦИ',
    'БАТИШНИЦА',
    'БАЧО КИРО',
    'БЕЗИМЕННА',
    'БЕЗМЕР',

    'БЕЛИ ИЗВОР',
    'БЕЛИЦА',
    'БЕЛОВО',
    'БЕЛОЗЕМ',
    'БЕЛОСЛАВ',
    'БЕЛЩИЦА',
    'БЕНКОВСКИ',
    'БЕРКОВИЦА',
    'БИСЕР',

    'БЛ.ЗАХАРИЕВ',
    'БЛАГОВО',
    'БЛАГОЕВГРАД',
    'БЛАГОЕВГРАД - СП.',
    'БОБОВ ДОЛ',
    'БОБОШЕВО',
    'БОВ',
    'БОГДАНЦИ',
    'БОЖИЧЕН',

    'БОЖКОВЦИ',
    'БОЖУРИЦА',
    'БОЖУРИЩЕ',
    'БОЗАДЖИ',
    'БОЙКА',
    'БОЙЧИНОВЦИ',
    'БОКИЛОВЦИ',
    'БОРОВО',
    'БОРОВЦИ',

    'БОРУЩИЦА',
    'БОРЯНА',
    'БОТЕВ',
    'БОТЕВО',
    'БОТУНЕЦ',
    'БРАЦИГОВО',
    'БРИГАДИР',
    'БРИГАДИРСКА СЛАВА',
    'БРУСАРЦИ',

    'БРУСЕН',
    'БРЪМЧА',
    'БРЯСТ',
    'БУНОВО',
    'БУРГАС-РАЗПРЕДЕЛИТЕЛНА',
    'БУРГАС-РАЗПРЕДЕЛИТЕЛНА-СПИРКА',
    'БУРГАС-ТОВАРНА',
    'БУТОВО',
    'БЪЗОВЕЦ',

    'БЪЛГАРОВО',
    'БЪРДОКВА',
    'БЯГА',
    'БЯЛ БРЯГ',
    'БЯЛА',
    'БЯЛО ПОЛЕ',
    'ВАКАРЕЛ',
    'ВАКАРЕЛ - СП.',
    'ВАРВАРА',

    'ВАРНА - СП.',
    'ВАСИЛ ЛЕВСКИ',
    'ВАСИЛОВЦИ',
    'ВЕДРОВО',
    'ВЕЛИКО ТЪРНОВО',
    'ВЕЛИНГРАД',
    'ВЕЛИНГРАД ЮГ',
    'ВЕЛИНО',
    'ВЕЛИЧКОВО',

    'ВЕНЧАН',
    'ВЕРИЛА',
    'ВЕРИНСКО',
    'ВЕТОВО',
    'ВЕТРЕН',
    'ВИДБОЛ',
    'ВИНИЦА',
    'ВИСОКА ПОЛЯНА',
    'ВЛАДАЯ',

    'ВЛАДИМИР ПАВЛОВ',
    'ВЛАДО ТРИЧКОВ',
    'ВЛАСАТИЦА',
    'ВОДНЯНЦИ',
    'ВОЛУЯК',
    'ВР.ДЕПО ПЛОВДИВ-СП.',
    'ВРАЦА',
    'ВРАЦА - СПИРКА',
    'ВРЪБНИЦА',

    'ВЪБЕЛ',
    'ВЪЛЧИ ДОЛ',
    'ВЪЛЧИН',
    'Г.ОРЯХОВИЦА-ПР.ПАРК',
    'ГАБАРЕВО',
    'ГАБРОВНИЦА',
    'ГАБРОВО',
    'ГАВРАИЛОВО',
    'ГАНЧОВЕЦ',

    'ГЕНЕРАЛ КИСЕЛОВО',
    'ГЕНЕРАЛ КОВАЧЕВ',
    'ГЕНЕРАЛ КОЛЕВО',
    'ГЕНЕРАЛ ТОДОРОВ',
    'ГЕНЕРАЛ ТОШЕВО',
    'ГЛУМЧЕ',
    'ГЛУХАР',
    'ГОЛЯМ ПОРОВЕЦ',
    'ГОЛЯМА ВОДА',

    'ГОЛЯМО ДРЯНОВО',
    'ГОЛЯМО НОВО',
    'ГОЛЯМО СЕЛО',
    'ГОРИЦА',
    'ГОРНА БАНЯ',
    'ГОРНА КРЕТА',
    'ГОРНА МАЛИНА',
    'ГОРНА МАХАЛА',
    'ГОРНА ОРЯХОВИЦА-РАЗПР.П.',

    'ГОРНИ ДЪБНИК',
    'ГОРНО БОТЕВО',
    'ГОРСКО ДЮЛЕВО',
    'ГРАДЕШНИЦА',
    'ГРАДИЩЕ',
    'ГРАФ ИГНАТИЕВО',
    'ГРИВИЦА',
    'ГУЛИЙНА БАНЯ',
    'ГУРКОВО',

    'ГЪЛЪБНИК',
    'ГЮЕШЕВО',
    'ДАГОНОВО',
    'ДАМЯНИЦА',
    'ДАСКАЛОВО',
    'ДВЕ МОГИЛИ',
    'ДЕБЕЛЕЦ',
    'ДЕБЕЛИ ЛАК',
    'ДЕВНЯ',

    'ДЕЛЯН',
    'ДЖЕБЕЛ',
    'ДЖЕРМАН',
    'ДЖУЛЮНИЦА',
    'ДИБИЧ',
    'ДИВДЯДОВО',
    'ДИМИТОВГРАД ЮГ СП.',
    'ДИМИТРИЕВО',
    'ДИМИТРОВГРАД',

    'ДИМИТРОВГРАД СЕВЕР',
    'ДИМИТРОВГРАД ЮГ',
    'ДИМОВО',
    'ДОБРИНА',
    'ДОБРИНИЩЕ',
    'ДОБРИНОВО',
    'ДОБРИЧ',
    'ДОБРИЧ - СЕВЕР',
    'ДОБРОДАН',

    'ДОЖДЕВИЦА',
    'ДОЙРЕНЦИ',
    'ДОЛАПИТЕ',
    'ДОЛЕНЕ',
    'ДОЛНА МАХАЛА',
    'ДОЛНА МИТРОПОЛИЯ',
    'ДОЛНИ ВИТ',
    'ДОЛНИ ДЪБНИК',
    'ДОЛНИ РАКОВЕЦ',

    'ДОЛНО ЕЗЕРОВО',
    'ДОЛНО КАМАРЦИ',
    'ДОЛНО СЕЛО',
    'ДОЛНО ЦЕРОВЕНЕ',
    'ДОНЧЕВО',
    'ДРАГИЧЕВО',
    'ДРАГОИЛ',
    'ДРАГОМАН',
    'ДРАГОМАН - СП.',

    'ДРАГОМИРОВО',
    'ДРАЛФА',
    'ДРАСОВ',
    'ДРЕНОВЕЦ',
    'ДРОПЛА-СПИРКА',
    'ДРУЖБА',
    'ДРЯНОВО',
    'ДРЯНОВО - СП.',
    'ДУЛОВО',

    'ДУНАВЦИ',
    'ДУПНИЦА',
    'ДУПНИЦА - СП.',
    'ДЪБЕНЕ',
    'ДЪБОВА МАХАЛА',
    'ДЪБОВО',
    'ДЪЛГА ЛЪКА',
    'ДЪЛГОПОЛ',
    'ДЪСКОТНА',

    'ДЮЛЕВО',
    'ДЯКОВО',
    'ЕГЪЛНИЦА',
    'ЕЗЕРОВО',
    'ЕЗЕРОВО-СПИРКА',
    'ЕЛЕНИНО',
    'ЕЛИН ПЕЛИН',
    'ЕЛИСЕЙНА',
    'ЕЛИТ',

    'ЕРДЕН',
    'ЖАБЛЯНО',
    'ЖЕГЛИЦА',
    'ЖЕЛЕЗНИЦА',
    'ЖЕЛЕН',
    'ЖЕЛЪД',
    'ЖЕЛЮ ВОЙВОДА',
    'ЖЕЛЯЗНА ВРАТА',
    'ЖИВКОВО',

    'ЖИТНИЦА',
    'ЖП.ШКОЛА - ЛАКАТНИК',
    'ЗАВЕТ',
    'ЗАВЕТ - СП.',
    'ЗАВОЙ - СП.',
    'ЗАХАРНА ФАБРИКА',
    'ЗВЕЗДЕЛИНА',
    'ЗВЕРИНО',
    'ЗВЪНИЧЕВО',

    'ЗДРАВЕЦ',
    'ЗЕМЕН',
    'ЗИМНИЦА',
    'ЗЛАТИЦА',
    'ЗЛАТНА НИВА',
    'ЗЛАТУША',
    'ЗМЕЙОВО',
    'ИВАН ВАЗОВО',
    'ИВАНКОВЦИ',

    'ИВАНОВО',
    'ИВАНСКИ',
    'ИВАНЯНЕ',
    'ИГАНОВО',
    'ИЛИЯНЦИ',
    'ИСКЪР',
    'ИСПЕРИХ',
    'ИХТИМАН',
    'ЙОГЛАВ',

    'КАДИЕВО',
    'КАЗАНЛЪК',
    'КАЗАЧЕВО',
    'КАЗИЧЕНЕ',
    'КАЛЕЙЦА',
    'КАЛИПЕТРОВО',
    'КАЛИТИНОВО',
    'КАЛИЩА',
    'КАЛОТИНА',

    'КАЛОТИНА-ЗАПАД',
    'КАЛОФЕР',
    'КАЛОЯНОВЕЦ',
    'КАЛОЯНОВО',
    'КАЛОЯНЦИ',
    'КАЛУГЕРИЦА',
    'КАМЕНЕЦ',
    'КАМЕННИ КАРИЕРИ',
    'КАМЕНО',

    'КАМЕНЯК',
    'КАРАВЕЛЬОВО',
    'КАРАГЕОРГИЕВО',
    'КАРАДЖАЛОВО',
    'КАРАДЖАТА',
    'КАРБИНЦИ',
    'КАРДАМ',
    'КАРЛОВО',
    'КАРЛУКОВО',

    'КАРНОБАТ',
    'КАСПИЧАН',
    'КАТУНИЦА',
    'КЕРМЕН',
    'КЕСАРЕВО',
    'КИПРА',
    'КИТАНЧЕВО',
    'КЛИКАЧ',
    'КЛИМАТ.УЧИЛИЩЕ',

    'КЛИМАШ',
    'КЛИСУРА',
    'КНИЖОВНИК',
    'КОВАЧЕВО',
    'КОЗАРЕВЕЦ',
    'КОЗАРСКО',
    'КОМАРЕВО',
    'КОМУНАРИ',
    'КОНАРЕ',

    'КОНДОФРЕЙ',
    'КОНСТАНТИНОВО',
    'КОНЬОВО',
    'КОПАНИЦА',
    'КОПИЛОВЦИ',
    'КОПРИВЩИЦА',
    'КОСТА ПЕТРОВ',
    'КОСТАНДОВО',
    'КОСТЕНЕЦ',

    'КОСТИНБРОД',
    'КОСТИНБРОД - СП.',
    'КОЧЕРИНОВО',
    'КОЧОВО',
    'КОШАРИТЕ',
    'КОШОВ',
    'КРАКРА',
    'КРЕМИКОВЦИ',
    'КРЕПОСТ',

    'КРЕСНА',
    'КРЕСНА - СП.',
    'КРЕТА',
    'КРИВА БАРА',
    'КРИВНЯ',
    'КРИВОДОЛ',
    'КРИЧИМ',
    'КРУМ',
    'КРУМОВО',

    'КРУШЕТО',
    'КРЪСТЕЦ',
    'КУБРАТОВО',
    'КУЛАТА',
    'КУМАРИЦА',
    'КУНИНО',
    'КУРИЛО',
    'КУРТОВО КОНАРЕ',
    'КУТУГЕРЦИ',

    'КУЦИНА',
    'КЪРДЖАЛИ',
    'КЪРНАРЕ',
    'КЪРШАЛЕВО',
    'КЮСТЕНДИЛ',
    'ЛАКАТНИК',
    'ЛЕВИЩЕ',
    'ЛЕВСКИ',
    'ЛЕСИЧЕРИ',

    'ЛЕСКА',
    'ЛЕТНИЦА',
    'ЛЕШНИЦА',
    'ЛИСТЕЦ',
    'ЛОВЕЦ',
    'ЛОВЕЧ',
    'ЛОВЕЧ - СП.',
    'ЛОВЕЧ - ЮГ',
    'ЛОВЕЧ-СЕВЕР',

    'ЛОЗАРЕВО',
    'ЛОЗОВО-СПИРКА',
    'ЛОКОРСКО',
    'ЛОМ',
    'ЛОМЕЦ',
    'ЛУКОВИТ',
    'ЛУКОВО',
    'ЛЮБИМЕЦ',
    'ЛЮЛЯКОВО',

    'ЛЮТИБРОД',
    'ЛЯХОВО',
    'МАВРУДОВО',
    'МАДАРА',
    'МАЗАРАЧЕВО',
    'МАКОЦЕВО',
    'МАКОЦЕВО - СП.',
    'МАКРЕШ',
    'МАЛЕВО',

    'МАЛО СЕЛО',
    'МАНОЛЕ',
    'МАНОЛОВО',
    'МАРЕК',
    'МАРИКОСТИНО',
    'МАРИНО ПОЛЕ',
    'МАРКО НИКОЛОВ',
    'МАСЛИНОВО',
    'МЕДКОВЕЦ',

    'МЕДОВИНА',
    'МЕЖДЕН',
    'МЕЗДРА ЮГ',
    'МЕРИЧЛЕРИ',
    'МЕРИЧЛЕРИ-СП.',
    'МЕТАЛ ТОВАРНА',
    'МЕТАЛ-СП.',
    'МИЛКОВИЦА',
    'МИРКОВО',

    'МИРКОВО - СП.',
    'МИХАЙЛОВО',
    'МИХАЛЦИ-СТАМБОЛОВО',
    'МЛАМОЛОВО',
    'МОКРИЩЕ',
    'МОМИН БРОД',
    'МОМИН ПРОХОД',
    'МОМИНА КЛИСУРА',
    'МОМИНА СКАЛА',

    'МОМЧИЛГРАД',
    'МОНТАНА',
    'МОРАВА',
    'МОРАВИЦА',
    'МОРУНИЦА',
    'МОРЯК',
    'МОСТ',
    'МУЛЕТАРОВО',
    'МУРСАЛЕВО',

    'МУСАЧЕВО',
    'МЪДРЕЦ',
    'МЪРЧЕВО',
    'МЪТНИЦА',
    'НАДАРЕВО',
    'НАДЕЖДА - СП.',
    'НЕВЕСТИНО',
    'НЕВША',
    'НЕГОВАН',

    'НЕГУШЕВО',
    'НЕМИРОВО',
    'НИКОЛАЕВО',
    'НОВА ЗАГОРА',
    'НОВА НАДЕЖДА',
    'НОВА ШИПКА',
    'ОБЕДИНЕНА',
    'ОБЕЛЯ',
    'ОБОРИЩЕ',

    'ОБРАЗЦОВ ЧИФЛИК',
    'ОВЧЕПОЛЦИ',
    'ОГНЯНОВО',
    'ОДЪРНЕ',
    'ОПЛЕТНЯ',
    'ОПЪЛЧЕНЕЦ',
    'ОРЕШ',
    'ОРЕШАК',
    'ОРЕШЕЦ',

    'ОРИЗОВО',
    'ОРЛИН',
    'ОСЕЛНА',
    'ОСЕТЕНОВО',
    'ОСЛЕН',
    'ОСТРЕЦ',
    'ОТДИХ',
    'ОХРИД',
    'ПАВЕЛ БАНЯ',

    'ПАВЛИКЕНИ',
    'ПАЗАРДЖИК',
    'ПАЛИ ЛУЛА',
    'ПАМПОРОВО - СП.',
    'ПАНАГЮРИЩЕ',
    'ПАРТИЗАНИ',
    'ПЕРНИК',
    'ПЕРНИК РАЗПРЕДЕЛИТ.',
    'ПЕРПЕРЕК',

    'ПЕСНОПОЙ',
    'ПЕТКО КАРАВЕЛОВО',
    'ПЕТРИЧ',
    'ПЕТЪРЧ',
    'ПЕЩЕРА',
    'ПЕЮ ЯВОРОВ',
    'ПИРДОП',
    'ПЛАЧКОВЦИ',
    'ПЛЕВЕН ЗАПАД',

    'ПЛИСКА',
    'ПЛОСКА МОГИЛА',
    'ПОБИТ КАМЪК',
    'ПОВЕЛЯНОВО',
    'ПОДВИС',
    'ПОДГОРИЦА',
    'ПОДЕМ',
    'ПОДКОВА',
    'ПОДУЯНЕ',

    'ПОДУЯНЕ РАЗПР.СР.Р.',
    'ПОДУЯНЕ РАЗПРЕДЕЛИТ.',
    'ПОЛИКРАИЩЕ',
    'ПОЛСКИ СЕНОВЕЦ',
    'ПОЛСКИ ТРЪМБЕШ',
    'ПОЛСКО КОСОВО',
    'ПОПОВИЦА',
    'ПОПОВО',
    'ПОРДИМ',

    'ПРАВДА',
    'ПРЕКОЛНИЦА',
    'ПРЕСЛАВЕЦ',
    'ПРИБОЙ',
    'ПРИЛЕП',
    'ПРОВАДИЯ',
    'ПРОЛЕТ',
    'ПРОСЛАВ',
    'ПРОСТОРНО',

    'ПТИЧАР',
    'ПЪРВОМАЙ',
    'РАВНА',
    'РАВНЕЦ',
    'РАВНО ПОЛЕ',
    'РАДАНОВО',
    'РАДЕВЦИ',
    'РАДКО ДИМИТРИЕВ',
    'РАДОВЕНЕ',

    'РАДОМИР',
    'РАДУЙ',
    'РАДУНЦИ',
    'РАЗГРАД',
    'РАЗДЕЛНА',
    'РАЗЛОГ',
    'РАЗМЕННА',
    'РАЗМЕННА - СП.',
    'РАКЕВО',

    'РАКОВСКИ',
    'РЕБРОВО',
    'РЕБЪРКОВО',
    'РЕСЕЛЕЦ - СП.',
    'РЕСЕН',
    'РОГОЗЧЕ',
    'РОЗИНО',
    'РОМАН',
    'РОМЧА',

    'РУЙНО',
    'РУПИТЕ',
    'РУПЦИ',
    'РУПЦИ - СЕВЕР',
    'РУСАЛЯ ДИЧИН',
    'РУСЕ РАЗПРЕДЕЛИТЕЛНА',
    'РУСЕ ТОВАРНА-СП.',
    'РУСКА БЯЛА',
    'РАЖДАВИЦА',

    'САДОВО',
    'САМОВОДЕНЕ',
    'САМУИЛ',
    'САМУИЛОВО',
    'САНДАНСКИ',
    'САРАНЦИ',
    'САХРАНЕ',
    'СБОРИЩЕ',
    'СВЕЖЕН',

    'СВЕТА ПЕТКА',
    'СВЕТИ ГЕОРГИ',
    'СВЕТЛЕН',
    'СВЕТЛИНА - СП.',
    'СВЕТОВРАЧАНЕ',
    'СВИЛЕНГРАД',
    'СВИЩОВ',
    'СВОБОДА',
    'СВОГЕ',
    'СЕЛИМИНОВО',

    'СЕНОВО',
    'СЕПТЕМВРИ',
    'СЕСТРИМО',
    'СИЛИСТРА',
    'СИМЕОНОВГРАД',
    'СИМИТЛИ',
    'СИНАГОВЦИ-ГУРКОВО',
    'СИНДЕЛ РАЗПРЕДЕЛИТ.',
    'СИНИТОВО',

    'СИНЬО БЪРДО',
    'СКАКАВИЦА',
    'СКОБЕЛЕВО',
    'СКОМЛЯ (КАНТОН-43)',
    'СКУТАРЕ',
    'СЛАВЯНОВО',
    'СЛАНА БАРА',
    'СЛИВЕН',
    'СЛИВНИЦА',

    'СЛИВНИЦА - СП.',
    'СМИЛЕЦ',
    'СМИРНЕНСКИ',
    'СМОЛЕВО',
    'СМЯДОВО',
    'СОВОЛЯНО',
    'СОКОЛОВО',
    'СОЛНА МИНА',
    'СОМОВИТ',

    'СОПОТ',
    'СОФИЯ СЕВЕР',
    'СПАСОВО',
    'СРАЦИМИР',
    'СРЕДНА АРДА',
    'СТАЙНОВЦИ',
    'СТАЛЕВО',
    'СТАЛИЙСКА МАХАЛА',
    'СТАМБОЛИЙСКИ',

    'СТАМБОЛОВО',
    'СТАМО КОСТОВ',
    'СТАРА ЗАГОРА ПОСТ 7',
    'СТАРА КРЕСНА',
    'СТОИЛ ВОЙВОДА',
    'СТОЙЧЕВЦИ',
    'СТОЛНИК',
    'СТРАЖИЦА',
    'СТРАЛДЖА',

    'СТРАШИМИРОВО',
    'СТРЕЛЧА',
    'СТРОИТЕЛ',
    'СТРУМЯНИ',
    'СТРУПЕЦ',
    'СТРУЯ',
    'СТРЯМА',
    'СТЪРМЕН',
    'СУВОРОВО',

    'СЪБОТКОВЦИ',
    'СЪЕДИНЕНИЕ',
    'ТАБАЧКА',
    'ТАНЮ ВОЙВОДА',
    'ТВЪРДИЦА',
    'ТЕЛИШ',
    'ТОДОР КАБЛЕШКОВ',
    'ТОДОРОВО',
    'ТОМПСЪН',

    'ТОПОЛИТЕ',
    'ТОПОЛИЦА',
    'ТОПОЛОВ ДОЛ',
    'ТРАЙКОВО',
    'ТРАКИЯ',
    'ТРАКИЯ (ШУМЕН)',
    'ТРАПЕЗИЦА',
    'ТРОЯН',
    'ТРУД',

    'ТРЪСТИКОВО',
    'ТРЯВНА',
    'ТУЛОВО',
    'ТЪЖА',
    'ТЪРГОВИЩЕ',
    'ТЪРНАК',
    'ТЪРНИЧАНИ',
    'УЗУНДЖОВО',
    'УМАРЕВЦИ',

    'УСОЙКА',
    'ФИЛИПОВО',
    'ХАДЖИЕВО',
    'ХАН АСПАРУХ',
    'ХАН КРУМ',
    'ХАРМАНЛИ',
    'ХАСКОВО',
    'ХЕРАКОВО',
    'ХИСАР',

    'ХИТРИНО',
    'ХЛЕВЕНЕ',
    'ХРАБЪРСКО',
    'ХРИСТИЯНОВО',
    'ХРИСТО ДАНОВО',
    'ХУМАТА',
    'ХЪРСОВО',
    'ЦАР АСЕН',
    'ЦАРАЦОВО',

    'ЦАРЕВА ЛИВАДА',
    'ЦАРЕВА ПОЛЯНА',
    'ЦАРЕВЦИ',
    'ЦВЕТИНО',
    'ЦЕПИНА',
    'ЦЕРКОВСКИ',
    'ЦЕРОВИЦА',
    'ЦЕРОВО',
    'ЧАВДАРЦИ',

    'ЧАКРИНИ',
    'ЧЕКАНЧЕВО',
    'ЧЕЛОПЕЧ',
    'ЧЕРВЕН БРЯГ',
    'ЧЕРВЕНА',
    'ЧЕРВЕНА ВОДА',
    'ЧЕРГАНОВО',
    'ЧЕРЕПИШ',
    'ЧЕРКВИЦА',

    'ЧЕРНА ГОРА',
    'ЧЕРНА МЕСТА',
    'ЧЕРНЕВО',
    'ЧЕРНИК',
    'ЧЕРНИЧЕ',
    'ЧЕРНИЧЕВО',
    'ЧЕРНОГОРОВО',
    'ЧЕРНОГРАД',
    'ЧЕРНОЗЕМ',

    'ЧЕСТОВО-СП.',
    'ЧЕШНИГИРОВО',
    'ЧИНТУЛОВО',
    'ЧИРПАН',
    'ЧИФЛИК',
    'ЧУКОВЕЦ',
    'ЧУМЕРНА',
    'ШИВАЧЕВО',
    'ШИРОКО ПОЛЕ',

    'ШИШКОВЦИ',
    'ШУМЕН',
    'ЮНАК',
    'ЮРУКОВО',
    'ЯБЪЛКОВО',
    'ЯВОРОВЕЦ',
    'ЯГОДА',
    'ЯГОДОВО',
    'ЯКОРУДА',

    'ЯМБОЛ',
    'ЯНА',
    'ЯНТРА',
    'ЯСЕН',
    'ЯСЕНОВЕЦ',
    'ЯСТРЕБОВО',
    'ЯХИНОВО',
]
all_stations = [unicode(s, 'utf-8').title() for s in all_stations]